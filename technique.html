<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Technique Astro – Placidus PRO</title>
</head>

<body>

<h2>Calcul Placidus — Version PRO Exacte</h2>

<label>Latitude (ex : 46° 06' N) :</label><br>
<input id="lat" type="text" value="46° 06' N"><br><br>

<label>Longitude (ex : 0h 12m 48s E) :</label><br>
<input id="lon" type="text" value="0h 12m 48s E"><br><br>

<label>Date (AAAA-MM-JJ) :</label><br>
<input id="date" type="date" value="1962-01-29"><br><br>

<label>Heure légale (HH:MM) :</label><br>
<input id="time" type="time" value="19:30"><br><br>

<button onclick="runCalc()">Calculer</button>

<hr>

<h3>Diagnostics :</h3>
<pre id="debug">Aucun calcul.</pre>

<h3>Résultats :</h3>
<pre id="output">Aucun calcul.</pre>

<script>
/* ============================================
   BLOC 1 — FONCTIONS DE BASE (SÉCURISÉ)
   ============================================ */

/* Conversions */
function toRad(d) { return d * Math.PI / 180; }
function toDeg(r) { return r * 180 / Math.PI; }
function normalize(a) { a = a % 360; return a < 0 ? a + 360 : a; }

/* Format astrologique */
function dms(a) {
    const d = Math.floor(a);
    const m = Math.round((a - d) * 60);
    return `${d}°${m.toString().padStart(2,"0")}'`;
}

const SIGNS = [
    "♈ Bélier","♉ Taureau","♊ Gémeaux","♋ Cancer",
    "♌ Lion","♍ Vierge","♎ Balance","♏ Scorpion",
    "♐ Sagittaire","♑ Capricorne","♒ Verseau","♓ Poissons"
];
function signOf(a) { return SIGNS[Math.floor(a/30)]; }

/* Décode latitude type "46° 06' N" */
function parseLat(latStr) {
    const m = latStr.match(/(\d+)°\s+(\d+)'?\s*(N|S)/i);
    const deg = parseInt(m[1]);
    const min = parseInt(m[2]);
    const sign = (m[3].toUpperCase()==="N") ? 1 : -1;
    return sign * (deg + min/60);
}

/* Décode longitude type "0h 12m 48s E" en SECONDES */
function parseLongitude(lonStr) {
    const m = lonStr.match(/(\d+)h\s+(\d+)m\s+(\d+)s\s+(E|O)/i);
    const h = parseInt(m[1]);
    const mn = parseInt(m[2]);
    const s = parseInt(m[3]);
    const sign = (m[4].toUpperCase()==="E") ? 1 : -1;
    return sign * (h*3600 + mn*60 + s);
}

/* Convertit secondes → HH:MM:SS */
function secToHMS(sec) {
    sec = (sec % 86400 + 86400) % 86400;
    const h = Math.floor(sec/3600);
    const m = Math.floor((sec%3600)/60);
    const s = Math.floor(sec%60);
    return `${h.toString().padStart(2,"0")}:${m.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}`;
}

</script>

</body>
</html>

